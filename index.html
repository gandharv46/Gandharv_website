<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PDF Viewer</title>

<style>
  :root{
    --bg:#0b0b0c;
    --card:#121215;
    --stroke:rgba(255,255,255,.12);
    --text:rgba(255,255,255,.9);
    --muted:rgba(255,255,255,.55);
  }

  html,body{
    margin:0;
    height:100%;
    background: var(--bg);
    color: var(--text);
    font-family: -apple-system, BlinkMacSystemFont, Inter, Segoe UI, Roboto, Helvetica, Arial;
    -webkit-overflow-scrolling: touch;
  }

  .container{
    max-width: 980px;
    margin: 0 auto;
    padding: 22px 14px 90px;
  }

  .page-wrap{
    background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
    border: 1px solid var(--stroke);
    border-radius: 16px;
    padding: 10px;
    margin-bottom: 18px;
    box-shadow: 0 20px 50px rgba(0,0,0,.35);
  }

  canvas{
    width: 100%;
    height: auto;
    display: block;
    border-radius: 12px;
    background: var(--card);
  }

  .hint{
    text-align:center;
    font-size:12px;
    color: var(--muted);
    margin-bottom: 14px;
  }

  /* MacBook-style bar */
  .macbar{
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: min(720px, calc(100% - 20px));
    height: 42px;
    border-radius: 18px;
    background: rgba(20,20,24,.75);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid rgba(255,255,255,.15);
    box-shadow: 0 12px 30px rgba(0,0,0,.4);
    display:flex;
    align-items:center;
    justify-content:center;
    gap:10px;
    font-size:12px;
    color:rgba(255,255,255,.75);
    pointer-events:none;
  }

  .dot{
    width:8px;
    height:8px;
    border-radius:50%;
    background:rgba(255,255,255,.25);
  }
</style>
</head>

<body>

<div class="container" id="container">
  <div class="hint">Scroll • Pages load smoothly</div>
</div>

<div class="macbar">
  <span class="dot"></span>
  <span>All rights reserved — Gandharv</span>
  <span class="dot"></span>
</div>

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.10.38/pdf.min.js"></script>
<script>
  const PDF_URL = "./mygd.pdf";

  pdfjsLib.GlobalWorkerOptions.workerSrc =
    "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.10.38/pdf.worker.min.js";

  const container = document.getElementById("container");
  const dpr = Math.min(window.devicePixelRatio || 1, 2);

  let pdfDoc = null;
  let rendered = new Set();

  function createPageShell(pageNum){
    const wrap = document.createElement("div");
    wrap.className = "page-wrap";
    wrap.dataset.page = pageNum;
    wrap.style.minHeight = "300px";
    return wrap;
  }

  async function renderPage(pageNum){
    if (rendered.has(pageNum)) return;
    rendered.add(pageNum);

    const page = await pdfDoc.getPage(pageNum);
    const viewport = page.getViewport({ scale: 1 });

    const scale = (container.clientWidth - 20) / viewport.width;
    const scaledViewport = page.getViewport({ scale });

    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = Math.floor(scaledViewport.width * dpr);
    canvas.height = Math.floor(scaledViewport.height * dpr);
    canvas.style.width = scaledViewport.width + "px";
    canvas.style.height = scaledViewport.height + "px";

    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

    await page.render({
      canvasContext: ctx,
      viewport: scaledViewport
    }).promise;

    const shell = container.querySelector(`[data-page="${pageNum}"]`);
    shell.innerHTML = "";
    shell.appendChild(canvas);
  }

  function observePages(){
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const pageNum = Number(entry.target.dataset.page);
          renderPage(pageNum);
        }
      });
    }, { rootMargin: "400px" });

    document.querySelectorAll(".page-wrap").forEach(p => observer.observe(p));
  }

  (async function init(){
    pdfDoc = await pdfjsLib.getDocument(PDF_URL).promise;

    for (let i = 1; i <= pdfDoc.numPages; i++) {
      container.appendChild(createPageShell(i));
    }

    observePages();
  })();
</script>

</body>
</html>
